$(document).ready(function(){function n(n,t){MostrarCargando();$.ajax({type:"POST",url:"/monitoreotest/comprobanterecibidoperiodo/AnularPeriodo",data:JSON.stringify({id:n,motivo:t}),dataType:"json",contentType:"application/json",success:function(n){n.success?location.reload():(Mensajes.MostrarError(n.error),OcultarCargando())}})}var t=$("#tbl").dataTable({bProcessing:!0,bServerSide:!0,ajax:{url:"/monitoreotest/comprobanterecibidoperiodo/ObtenerListadoIndex",type:"POST"},bLengthChange:!0,bFilter:!0,bSort:!0,bInfo:!0,order:[[0,"desc"]],aoColumns:[{bSortable:!0,sWidth:"20%"},{bSortable:!0,sWidth:"18%"},{bSortable:!0,sWidth:"18%"},{bSortable:!0,sWidth:"24%"},{bSortable:!1,sWidth:"20%",mRender:function(n,t,i){var r="",u=i[5],f=i[6],e=i[7],o=i[8],s=i[9];return u?(s&&(r+='&nbsp;<a class="btn btn-info btn-xs btn-visualizar" id="'+n+'">Visualizar<\/a>'),r+='&nbsp;<a class="btn btn-danger btn-xs btn-ver-elimino" id="'+n+'">Anulado (+info)<\/a>'):(r+='&nbsp;<a class="btn btn-info btn-xs btn-visualizar" id="'+n+'">Visualizar<\/a>',f&&o&&(r+='&nbsp;<a class="btn btn-primary btn-xs btn-editar" id="'+n+'">Editar<\/a>'),e&&(r+='&nbsp;<a class="btn btn-danger btn-xs btn-eliminar" id="'+n+'">Anular<\/a>')),r}}]});$("#tbl").on("click",".btn-ver-elimino",function(n){var t=n.currentTarget.id;$.ajax({type:"POST",url:"/monitoreotest/comprobanterecibidoperiodo/ObtenerInfoAnulacion",data:JSON.stringify({id:t}),dataType:"json",contentType:"application/json",success:function(n){var t="";t+="<b>ANULÓ:<\/b>&nbsp;"+n.anulo+"<br/>";t+="<b>FECHA HORA:<\/b>&nbsp;"+n.fechaHora+"<br/>";t+="<b>MOTIVO:<\/b>&nbsp;"+n.motivo+"<br/>";Mensajes.MostrarOK(t)}})});$("#tbl").on("click",".btn-eliminar",function(n){var t=n.currentTarget.id;Mensajes.MostrarSiNo("¿Desea anular el período?\nATENCIÓN: Se anularán también sus facturas cargadas.",function(){$("#EliminarPeriodoId").val(t);$("#MotivoModal").modal("show")})});$("#tbl").on("click",".btn-editar",function(n){var t=n.currentTarget.id;location.href="/monitoreotest/comprobanterecibidoperiodo/Editar?id="+t});$("#tbl").on("click",".btn-visualizar",function(n){var t=n.currentTarget.id;location.href="/monitoreotest/comprobanterecibidoperiodo/Editar?id="+t+"&sv=a"});$("#btnMotivoContinuar").click(function(){var i=parseInt($("#EliminarPeriodoId").val()),t=$("#TextMotivo").val();if(t.length<=3){Mensajes.MostrarError("Debes ingresar un motivo.");return}n(i,t)})});